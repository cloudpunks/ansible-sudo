- name: install packages
  loop:
    - sudo
  package:
    name: '{{ item }}'
    state: present
  tags:
    - sudo

- name: create group
  loop: '{{ sudo_groups }}'
  group:
    name: '{{ item }}'
    system: yes
    state: present
  tags:
    - sudo

- name: write sudoers
  template:
    src: sudoers.j2
    dest: /etc/sudoers
    validate: /usr/sbin/visudo -cf %s
  tags:
    - sudo
